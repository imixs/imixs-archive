<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/layout/template.xhtml">

	<ui:define name="content">

		<div class="imixs-form">
			<div class="imixs-header">
				<h1>
					<span class="typcn typcn-plug"></span>Configuration
				</h1>
				<p>Connect to Imixs-Worklfow remote Rest API</p>
			</div>
			<hr />

			<div class="row">

				<div class="col-6">
					<form
						action="#{facesContext.externalContext.requestContextPath}/imixsarchive/archive/"
						method="post">

						<div class="imixs-form-section">
							<h3>Keyspace:</h3>
							<dl>
								<dt>Name:</dt>
								<dd>
									<!-- not editable if already defined! -->
									<ui:fragment
										rendered="#{!empty configurationDataController.configuration.item['keyspace']}">

										<input type="text" disabled="disabled"
											value="#{configurationDataController.configuration.item['keyspace']}" />
										<input type="hidden"
											value="#{configurationDataController.configuration.item['keyspace']}"
											name="keyspace" />
									</ui:fragment>
									<ui:fragment
										rendered="#{empty configurationDataController.configuration.item['keyspace']}">
										<input type="text"
											value="#{configurationDataController.configuration.item['keyspace']}"
											name="keyspace" />
									</ui:fragment>
								</dd>
							</dl>


							<dl>
								<dt>#{message.endpoint}:</dt>
								<dd>
									<input type="text"
										value="#{configurationDataController.configuration.item['url']}"
										autocomplete="url" name="url" />
								</dd>
							</dl>
						</div>

						<div class="imixs-form-section-2">
							<dl>
								<dt>UserID:</dt>
								<dd>
									<input type="text"
										value="#{configurationDataController.configuration.item['userid']}"
										autocomplete="username" name="userid" />
								</dd>
							</dl>

							<dl>
								<dt>Password:</dt>
								<dd>
									<input type="password"
										value="#{configurationDataController.configuration.item['password']}"
										autocomplete="current-password" name="password" />
								</dd>
							</dl>
							<dl>
								<dt>Authentication:</dt>
								<dd>
									<select name="authmethod">
										<ui:fragment
											rendered="#{configurationDataController.configuration.item['authMethod'] eq 'Form'}">
											<option value="Basic">Basic</option>
											<option value="Form" selected="selected">Form</option>
										</ui:fragment>
										<ui:fragment
											rendered="#{configurationDataController.configuration.item['authMethod'] ne 'Form'}">
											<option value="Basic" selected="selected">Basic</option>
											<option value="Form">Form</option>
										</ui:fragment>
									</select>
								</dd>
							</dl>





						</div>



						<div class="imixs-form-section">
							<h3>Timer Settings:</h3>

							<div class="row nested">
								<div class="col-8">
									<textarea name="_scheduler_definition" rows="" cols=""
										style="height: 11em; width: 100%;">#{configurationDataController.configuration.item['_scheduler_definition']}</textarea>
								</div>
								<div class="col-4">
									<SMALL> <span style="text-decoration: underline;"><strong><a
												href="https://docs.oracle.com/javaee/7/api/javax/ejb/ScheduleExpression.html"
												target="_blank">Cron Settings:</a></strong></span> <br />second [0,59]<br />
										minute [0,59]<br /> hour [0,23]<br /> dayOfWeek [1,31]<br />
										dayOfMonth [1,12]<br /> year<br /></SMALL>
								</div>
							</div>
						</div>

						<!-- **** Timer Status ***** -->
						<div class="imixs-form-panel">
							<div id="timer_details" class="imixs-form-section">

								<h3>Timer Status â‡¢
									#{configurationDataController.configuration.item['statusMessage']}


								</h3>
								<ui:fragment
									rendered="#{! empty configurationDataController.configuration.item['errormessage']}">
									<h3 class="small" style="color: red">Error:
										#{configurationDataController.configuration.item['errormessage']}</h3>
								</ui:fragment>

								<table>

									<tr>
										<td>Sync Point :</td>
										<td>#{configurationDataController.syncPoint}</td>
									</tr>
									<tr>
										<td>Schedule:</td>
										<td>#{configurationDataController.configuration.item['Schedule']}</td>


									</tr>
									<tr>
										<td>Next Timeout:</td>
										<td>#{configurationDataController.configuration.item['nextTimeout']}</td>
									</tr>

									<tr>
										<td>TimeRemaining:</td>
										<td>#{configurationDataController.configuration.item['timeRemaining']}</td>
									</tr>
									<tr>

										<td>Last run:</td>
										<td>#{configurationDataController.configuration.item['datLastRun']}</td>
									</tr>

									<tr>
										<td>Log:</td>
										<td><pre>
												<ui:repeat var="logentry"
													value="#{workitem.itemList['_scheduler_log']}">
													#{logentry}"
														<br />
												</ui:repeat>
											</pre></td>
									</tr>
								</table>


								<hr />

							</div>
						</div>



						<hr />
						<div class="imixs-form-section">

							<input type="submit"
								value="#{empty configurationDataController.configuration.item['keyspace']?'Create':'Update'}" />

							<input type="button"
								onclick="document.location.href='#{facesContext.externalContext.requestContextPath}/imixsarchive/archive/';"
								value="Close" />
							<ui:fragment rendered="#{! empty errorController.message}">

								<h3 style="color: red">#{errorController.message}</h3>

							</ui:fragment>
						</div>
					</form>

				</div>
			</div>
		</div>




	</ui:define>
</ui:composition>
