<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
	template="/layout/template.xhtml">


	<ui:define name="content">

		<h:form>
			<div class="imixs-form">
				<div class="imixs-header">
					<h1>
						<span class="typcn typcn-chart-bar-outline"></span>Monitor
					</h1>
				</div>

				<div class="row">


					<div class="col-12">
						<div class="monitor-portlet">
							<h1>Archive Status:</h1>
							<table style="width: 100%; margin-bottom: 10px;">

								<tr>
									<td style="width: 25%;">Cluster Contact Points:</td>
									<td>#{clusterDataController.contactPoints}</td>
								</tr>

								<tr>
									<td>KeySpace:</td>
									<td>#{clusterDataController.keySpace}</td>
								</tr>


								<tr>
									<td>Replication Factor:</td>
									<td>#{clusterDataController.replicationFactor}</td>
								</tr>
								<tr>
									<td>Replication Strategy:</td>
									<td>#{clusterDataController.replicationClass}</td>
								</tr>


								<tr>
									<td>Connecton Status:</td>
									<td><ui:fragment
											rendered="#{clusterDataController.connected}">
							OK <span class="typcn typcn-media-record"
												style="font-size: 1.3em; color: #5c9e5c;"></span>
										</ui:fragment> <ui:fragment rendered="#{!clusterDataController.connected}">
							Failed <span class="typcn typcn-media-record"
												style="font-size: 1.3em; color: #e84848;"></span>
										</ui:fragment></td>
								</tr>

								<tr>
									<td style="width: 25%;">Endpoint:</td>
									<td>#{clusterDataController.serviceEndpoint}</td>
								</tr>

							</table>


							<!-- load meta data -->
							<!-- html -->
							<a target="_blank" class="button" href="/api/archive/metadata">Metadata</a>
							<!-- xml -->
							<a target="_blank" class="button"
								href="/api/archive/metadata?format=xml">Metadata XML</a>
							<!-- json -->
							<a target="_blank" class="button"
								href="/api/archive/metadata?format=json">Metadata JSON</a>

						</div>
					</div>
				</div>
				<div class="row">

					<div class="col-12">
						<div class="monitor-portlet">

							<h1><span>Resync Status: </span> 
							<ui:fragment
											rendered="#{clusterDataController.isRunning()}">
							<span class="typcn typcn-media-record"
												style="font-size: 1.3em; color: #5c9e5c;float:none"></span>
												<span> RUNNING</span>
										</ui:fragment> <ui:fragment rendered="#{!clusterDataController.isRunning()}">
							 <span class="typcn typcn-media-record"
												style="font-size: 1.3em; color: #e84848;float:none"></span><span> STOPPED</span>
										</ui:fragment></h1>

							<p class="lead" style="float: left; width: 48%;">
								<span class="typcn typcn-shopping-cart" style="color: #5c9e5c;"></span>
								#{clusterDataController.syncSize} <span style="font-size: 0.3em">#{clusterDataController.syncSizeUnit}</span>
							</p>

							<p class="lead" style="">
								<span class="typcn typcn-arrow-repeat-outline"
									style="color: #5c9e5c;"></span>
								#{clusterDataController.syncCount} <span
									style="font-size: 0.3em">total syncs</span>
							</p>

							<p class="small">Last ReSync:
								#{clusterDataController.syncPoint}  </p>
							
							<!-- Start / Stop sync scheduler -->
							<p style="margin-top: 10px;">
								<h:commandButton value="start"
									action="monitor?faces-redirect=true"
									rendered="#{!clusterDataController.isRunning()}"
									actionListener="#{clusterDataController.start()}"></h:commandButton>

								<h:commandButton value="stop"
									action="monitor?faces-redirect=true"
									rendered="#{clusterDataController.isRunning()}"
									actionListener="#{clusterDataController.cancel()}"></h:commandButton>
							</p>


						</div>
					</div>
				</div>


				<div class="row">


					<div class="col-12">
						<div class="monitor-portlet">
							<h1>Resync-Log:</h1>
							<p class="small">
								<ui:repeat var="entry" value="#{clusterDataController.messages}">
								#{entry}
								<br />
								</ui:repeat>
							</p>
						</div>
					</div>

				</div>
			</div>
		</h:form>
	</ui:define>
</ui:composition>
